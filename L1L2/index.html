<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>正規化 (Regularization) - 互動教學</title>
    <meta name="description" content="互動式展示 L1 (Lasso) 與 L2 (Ridge) 正規化如何抑制過擬合">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        <header class="header">
            <h1>🛡️ 正規化 (Regularization)</h1>
            <p class="subtitle">馴服狂野的模型：L1 (Lasso) vs. L2 (Ridge)</p>
        </header>

        <main class="main-content">
            <!-- 左側：視覺化區域 -->
            <section class="visualization-section">
                <div class="canvas-container">
                    <canvas id="mainCanvas"></canvas>
                </div>

                <!-- 權重視覺化 (重要！) -->
                <div class="weights-visual">
                    <h3>⚖️ 權重分佈 (Weights)</h3>
                    <canvas id="weightsCanvas"></canvas>
                </div>
            </section>

            <!-- 右側：控制面板 -->
            <aside class="control-section">
                <!-- 模型設定 -->
                <div class="card">
                    <h3>🛠️ 模型設定</h3>

                    <div class="control-group">
                        <label>多項式階數 (Degree): <span id="degreeVal">10</span></label>
                        <input type="range" id="degreeSlider" min="1" max="15" value="10" step="1">
                        <p class="hint">階數越高，模型越容易過擬合</p>
                    </div>

                    <div class="control-group">
                        <label>樣本數量 (Points): <span id="pointsVal">15</span></label>
                        <input type="range" id="pointsSlider" min="5" max="30" value="15" step="1">
                    </div>

                    <div class="control-group">
                        <label>雜訊程度 (Noise): <span id="noiseVal">20</span></label>
                        <input type="range" id="noiseSlider" min="0" max="50" value="20">
                    </div>

                    <button id="resetDataBtn" class="btn-secondary">🎲 重新生成數據</button>
                </div>

                <!-- 正規化控制 -->
                <div class="card highlight-card">
                    <h3>🛡️ 正規化設定</h3>

                    <div class="reg-type-selector">
                        <label class="radio-label">
                            <input type="radio" name="regType" value="none" checked>
                            <span>None</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="regType" value="l1">
                            <span>L1 (Lasso)</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="regType" value="l2">
                            <span>L2 (Ridge)</span>
                        </label>
                    </div>

                    <div class="control-group">
                        <label>懲罰強度 (&lambda;): <span id="lambdaVal">0.00</span></label>
                        <input type="range" id="lambdaSlider" min="0" max="100" value="0" step="1">
                        <p class="hint" id="regHint">目前未啟用正規化，模型將盡力擬合所有噪聲。</p>
                    </div>
                </div>

                <!-- 訓練控制 -->
                <div class="card">
                    <h3>🚀 訓練控制 (梯度下降)</h3>

                    <div class="metrics">
                        <div class="metric">
                            <span>MSE Loss</span>
                            <span id="lossDisplay">0.00</span>
                        </div>
                        <div class="metric">
                            <span>Epochs</span>
                            <span id="epochDisplay">0</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>學習率 (Learning Rate): <span id="lrVal">0.01</span></label>
                        <input type="range" id="lrSlider" min="0.001" max="0.1" value="0.01" step="0.001">
                    </div>

                    <button id="trainBtn" class="btn-primary">▶ 開始訓練</button>
                    <button id="resetModelBtn" class="btn-text">⟲ 重置參數</button>
                </div>
            </aside>
        </main>

        <!-- 教學說明 -->
        <section class="info-section">
            <div class="info-grid">
                <div class="card info-card">
                    <h3>🔍 什麼是正規化？</h3>
                    <p>正規化是在損失函數中加入「懲罰項 (Penalty)」，強迫模型不要過度學習雜訊，保持權重簡單。</p>
                    <div class="formula-box">Loss = MSE + &lambda; &times; Penalty</div>
                </div>

                <div class="card info-card">
                    <h3>💎 L1 Regularization (Lasso)</h3>
                    <p>懲罰權重的<strong>絕對值總和</strong>。</p>
                    <div class="formula-box secondary">Penalty = &sum; |w<sub>i</sub>|</div>
                    <ul class="feature-list">
                        <li>特點：傾向產生<strong>稀疏解 (Sparse Solution)</strong>。</li>
                        <li>效果：會把不重要的特徵權重變成 <strong>0</strong> (特徵選取)。</li>
                        <li>幾何意義：解空間是菱形，容易在座標軸上相切。</li>
                        <li>使用時機：希望模型自動挑選重要特徵 (Model Selection)，或希望模型解更稀疏 (Interpretability) 時。</li>

                    </ul>
                    <div class="img-container">
                        <img src="img/l1.svg" alt="L1 Geometry" class="concept-img">
                    </div>
                </div>

                <div class="card info-card">
                    <h3>🔵 L2 Regularization (Ridge)</h3>
                    <p>懲罰權重的<strong>平方總和</strong>。</p>
                    <div class="formula-box primary">Penalty = &sum; w<sub>i</sub><sup>2</sup></div>
                    <ul class="feature-list">
                        <li>特點：傾向產生<strong>小數值權重</strong>。</li>
                        <li>效果：會把權重壓得很小，但不會變成 0。</li>
                        <li>幾何意義：解空間是圓形。</li>
                        <li>使用時機：特徵之間可能互相關聯 (共線性)，或希望保留所有特徵但減少過擬合時。</li>

                    </ul>
                    <div class="img-container">
                        <img src="img/l2.svg" alt="L2 Geometry" class="concept-img">
                    </div>
                </div>

                <div class="card info-card">
                    <h3>💡 觀察重點</h3>
                    <ol class="steps-list">
                        <li>設定較高的 <strong>Degree (如 10)</strong> 與少量數據。</li>
                        <li>不開正規化時，預測曲線會劇烈震盪 (過擬合)。</li>
                        <li>開啟 <strong>L2</strong>，曲線變平滑，權重變小。</li>
                        <li>開啟 <strong>L1</strong>，曲線變平滑，且<strong>許多權重變成 0</strong> (看下方長條圖)。</li>
                    </ol>
                </div>
            </div>
        </section>

        <footer class="footer">
            <p>🎓 高雄市立楠梓高中互動式機器學習教學平台</p>
            <a href="../index.html" class="back-home">🏠 返回主畫面</a>
        </footer>
    </div>

    <script src="script.js"></script>
</body>

</html>